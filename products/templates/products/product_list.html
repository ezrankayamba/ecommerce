{% extends 'core/base.html' %} {% load static %} {% block content %}
<div id="carousel-products" class="carousel slide" data-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="..." class="d-block w-100" alt="..." />
    </div>
    <div class="carousel-item">
      <img src="..." class="d-block w-100" alt="..." />
    </div>
    <div class="carousel-item">
      <img src="..." class="d-block w-100" alt="..." />
    </div>
  </div>
  <a
    class="carousel-control-prev"
    href="#carousel-products"
    role="button"
    data-slide="prev"
  >
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a
    class="carousel-control-next"
    href="#carousel-products"
    role="button"
    data-slide="next"
  >
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
<div class="product-container">
  {% for product in object_list %}
  <div class="product-display">
    <div class="slideshow">
      {% for prd_img in product.images.all %}
      <img class="slide" src="{{ prd_img.image.url }}" />
      {% empty %}
      <img
        class="slide"
        src="{% static 'core/img/product-image-placeholder.png' %}"
      />
      {% endfor %}
    </div>
    <div class="product-content">
      <h5>{{ product.title }}</h5>
      <p>{{ product.description }}</p>
    </div>
  </div>
  {% endfor %}
</div>

<script type="text/javascript">
  function sleep(delay) {
    var start = new Date().getTime();
    while (new Date().getTime() < start + delay);
  }
  let slideshows = document.querySelectorAll(".slideshow");

  slideshows.forEach(slideshow => {
    let sidx = 0;
    let slides = slideshow.querySelectorAll(".slide");
    let slideMe = () => {
      console.log("Slide me ...", sidx);
      slides.forEach(slide => {
        slide.classList.remove("slide-show");
      });
      sidx++;
      if (sidx > slides.length) {
        sidx = 1;
      }
      slides[sidx - 1].classList.add("slide-show");
      setTimeout(slideMe, 8000);
    };
    slideMe();
  });
</script>
{% endblock %}
